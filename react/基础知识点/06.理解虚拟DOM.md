### 虚拟DOM

​		什么是虚拟Dom？

+ 虚拟 DOM 是 JS 对象

+ 虚拟 DOM 是对真实 DOM 的描述

### 虚拟Dom的工作

​		在组件的挂载和更新阶段，都会出现虚拟DOM的身影

+ **挂载阶段**，React结合JSX的描述，构建虚拟DOM树，然后通过ReactDOM.render实现虚拟DOM到真实DOM的映射（触发渲染流水线）;
+ **更新阶段**,页面的变化在作用于真实的DOM之前，会先作用于虚拟DOM，虚拟DOM将在JS层借助算法对比哪些真实DOM需要被改变，然后作用于真实DOM;

### 虚拟DOM的价值

+ 研发体验/研发效率的问题：这一点前面已经反复强调过，DOM 操作模式的每一次革新，背后都是前端对效率和体验的进一步追求。虚拟 DOM 的出现，为数据驱动视图这一思想提供了高度可用的载体，使得前端开发能够基于函数式 UI 的编程方式实现高效的声明式编程。

+ 跨平台的问题：虚拟 DOM 是对真实渲染内容的一层抽象。若没有这一层抽象，那么视图层将和渲染平台紧密耦合在一起，为了描述同样的视图内容，你可能要分别在 Web 端和 Native 端写完全不同的两套甚至多套代码。但现在中间多了一层描述性的虚拟 DOM，它描述的东西可以是真实 DOM，也可以是iOS 界面、安卓界面、小程序......同一套虚拟 DOM，可以对接不同平台的渲染逻辑，从而实现“一次编码，多端运行”，如下图所示。其实说到底，跨平台也是研发提效的一种手段，它在思想上和1是高度呼应的。

![img](https://s0.lgstatic.com/i/image/M00/69/AE/CgqCHl-otLSAT1ivAACwY9bVkZQ836.png) 



### diff 策略的设计思想

+ Diff 算法性能突破的关键点在于“分层对比”；

+ 类型一致的节点才有继续 Diff 的必要性；

+ key 属性的设置，可以帮我们尽可能重用同一层级内的节点。